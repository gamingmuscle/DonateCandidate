{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from \"react\";\nimport { connect } from \"react-redux\";\nimport * as actions from \"../actions/DCandidate\";\n\nconst useForm = _ref => {\n  _s();\n\n  let {\n    initFieldValues,\n    ...props\n  } = _ref;\n  let validationPatterns = {};\n\n  const setValidationPatterns = p => {\n    //{key:{required:boolean,pattern: regex string}}\n    validationPatterns = { ...p\n    };\n  };\n\n  const [values, setValues] = useState(initFieldValues);\n  const inputLabel = /*#__PURE__*/React.createRef();\n  const [labelWidth, setLabelWidth] = React.useState(0);\n  React.useEffect(() => {\n    setLabelWidth(inputLabel.current.offsetWidth);\n  });\n\n  const handleInputChange = e => {\n    const {\n      name,\n      value\n    } = e.target;\n    console.log(name + \":\" + value);\n    setValues({ ...values,\n      [name]: value\n    });\n    if (validationPatterns[name]) validateForm({ ...{\n        [name]: validationPatterns[name]\n      }\n    });\n  };\n\n  const handleFormSubmit = e => {\n    e.preventDefault();\n    console.log(values);\n\n    if (validateForm()) {\n      props.createDCandidate(values, () => {\n        window.alert(\"Inserted!\");\n      });\n    }\n  };\n\n  const [errors, setErrors] = useState({});\n\n  const validateForm = function () {\n    let fieldValidation = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : validationPatterns;\n    //{key:{required: boolean,pattern:...},...}\n    let temp = {};\n    console.log(fieldValidation);\n    console.log(values);\n    Object.keys(fieldValidation).map((key, i) => {\n      //just check for a value\n      if (fieldValidation[key].required && !values[key]) {\n        console.log(key + \":\" + values[key]);\n        temp[key] = values[key] ? \"\" : \"This field is required.\";\n      }\n\n      if (values[key] && fieldValidation[key].pattern) {\n        const regEx = RegExp(fieldValidation[key].pattern, \"g\");\n        temp[key] = regEx.test(values[key]) ? \"\" : \"Invalid value\";\n      }\n    });\n    console.log(temp);\n    setErrors({ ...temp\n    });\n    if (fieldValidation == validationPatterns) return Object.values(temp).every(x => x == \"\");\n  };\n\n  return {\n    values,\n    setValues,\n    handleInputChange,\n    inputLabel,\n    labelWidth,\n    setLabelWidth,\n    handleFormSubmit,\n    validateForm,\n    validationPatterns,\n    setValidationPatterns,\n    errors,\n    setErrors\n  };\n};\n\n_s(useForm, \"3FwiCu3MBiMHxTd3n7hpta88VNk=\");\n\nconst mapStateToProps = state => ({\n  dCandidateData: state.dCandidate.data\n});\n\nconst mapActionToProps = {\n  createDCandidate: actions.create,\n  updateDCandidate: actions.update\n};\nexport default connect(mapStateToProps, mapActionToProps)(useForm);","map":{"version":3,"names":["React","useState","useEffect","connect","actions","useForm","initFieldValues","props","validationPatterns","setValidationPatterns","p","values","setValues","inputLabel","createRef","labelWidth","setLabelWidth","current","offsetWidth","handleInputChange","e","name","value","target","console","log","validateForm","handleFormSubmit","preventDefault","createDCandidate","window","alert","errors","setErrors","fieldValidation","temp","Object","keys","map","key","i","required","pattern","regEx","RegExp","test","every","x","mapStateToProps","state","dCandidateData","dCandidate","data","mapActionToProps","create","updateDCandidate","update"],"sources":["C:/Users/Tom/source/repos/donate-candidate-app/src/components/useForm.js"],"sourcesContent":["import React,{useState,useEffect} from \"react\"\r\nimport { connect } from  \"react-redux\";\r\nimport * as actions  from \"../actions/DCandidate\"\r\n\r\nconst useForm = ({initFieldValues, ...props}) => {\r\n    let validationPatterns={}\r\n    const setValidationPatterns= p=>{//{key:{required:boolean,pattern: regex string}}\r\n        validationPatterns={...p}\r\n    }\r\n    const [values,setValues]= useState(initFieldValues)\r\n    const inputLabel = React.createRef();\r\n    const [labelWidth,setLabelWidth]= React.useState(0);\r\n    React.useEffect(()=>{setLabelWidth(inputLabel.current.offsetWidth)})\r\n\r\n    const handleInputChange = e =>{\r\n        const {name,value}= e.target\r\n        console.log(name+\":\"+value)\r\n        setValues({\r\n            ...values,\r\n            [name]:value\r\n        })\r\n        if(validationPatterns[name])\r\n            validateForm({...{[name]:validationPatterns[name]}})\r\n    }\r\n    const handleFormSubmit = e => {\r\n        e.preventDefault()\r\n        console.log(values);    \r\n        if(validateForm())\r\n        {\r\n            props.createDCandidate(values,()=>{window.alert(\"Inserted!\")})\r\n        }\r\n    }\r\n    const [errors,setErrors] = useState({})\r\n\r\n    const validateForm = (fieldValidation=validationPatterns) =>{//{key:{required: boolean,pattern:...},...}\r\n        let temp={}\r\n        console.log(fieldValidation)\r\n        console.log(values)\r\n        Object.keys(fieldValidation).map((key,i)=>{//just check for a value\r\n            if(fieldValidation[key].required && !values[key])\r\n            {\r\n                console.log(key+\":\"+values[key])\r\n                temp[key]=values[key]?\"\":\"This field is required.\"\r\n            }\r\n            if(values[key] && fieldValidation[key].pattern)\r\n            {\r\n                const regEx=RegExp(fieldValidation[key].pattern,\"g\")\r\n                temp[key] = regEx.test(values[key])?\"\":\"Invalid value\"\r\n            }\r\n            \r\n        })\r\n        console.log(temp)\r\n        setErrors({\r\n            ...temp\r\n        })\r\n        if(fieldValidation==validationPatterns)\r\n            return Object.values(temp).every(x=> x == \"\")\r\n    }\r\n    return {\r\n        values,\r\n        setValues,\r\n        handleInputChange,\r\n        inputLabel,\r\n        labelWidth,\r\n        setLabelWidth,\r\n        handleFormSubmit, \r\n        validateForm,\r\n        validationPatterns,\r\n        setValidationPatterns,\r\n        errors,\r\n        setErrors    \r\n    };\r\n}\r\nconst mapStateToProps = state => ({\r\n    dCandidateData:state.dCandidate.data\r\n});\r\n\r\nconst mapActionToProps = {\r\n    createDCandidate:actions.create,\r\n    updateDCandidate:actions.update,\r\n}\r\nexport default connect(mapStateToProps,mapActionToProps)(useForm);"],"mappings":";;AAAA,OAAOA,KAAP,IAAcC,QAAd,EAAuBC,SAAvB,QAAuC,OAAvC;AACA,SAASC,OAAT,QAAyB,aAAzB;AACA,OAAO,KAAKC,OAAZ,MAA0B,uBAA1B;;AAEA,MAAMC,OAAO,GAAG,QAAiC;EAAA;;EAAA,IAAhC;IAACC,eAAD;IAAkB,GAAGC;EAArB,CAAgC;EAC7C,IAAIC,kBAAkB,GAAC,EAAvB;;EACA,MAAMC,qBAAqB,GAAEC,CAAC,IAAE;IAAC;IAC7BF,kBAAkB,GAAC,EAAC,GAAGE;IAAJ,CAAnB;EACH,CAFD;;EAGA,MAAM,CAACC,MAAD,EAAQC,SAAR,IAAoBX,QAAQ,CAACK,eAAD,CAAlC;EACA,MAAMO,UAAU,gBAAGb,KAAK,CAACc,SAAN,EAAnB;EACA,MAAM,CAACC,UAAD,EAAYC,aAAZ,IAA4BhB,KAAK,CAACC,QAAN,CAAe,CAAf,CAAlC;EACAD,KAAK,CAACE,SAAN,CAAgB,MAAI;IAACc,aAAa,CAACH,UAAU,CAACI,OAAX,CAAmBC,WAApB,CAAb;EAA8C,CAAnE;;EAEA,MAAMC,iBAAiB,GAAGC,CAAC,IAAG;IAC1B,MAAM;MAACC,IAAD;MAAMC;IAAN,IAAcF,CAAC,CAACG,MAAtB;IACAC,OAAO,CAACC,GAAR,CAAYJ,IAAI,GAAC,GAAL,GAASC,KAArB;IACAV,SAAS,CAAC,EACN,GAAGD,MADG;MAEN,CAACU,IAAD,GAAOC;IAFD,CAAD,CAAT;IAIA,IAAGd,kBAAkB,CAACa,IAAD,CAArB,EACIK,YAAY,CAAC,EAAC,GAAG;QAAC,CAACL,IAAD,GAAOb,kBAAkB,CAACa,IAAD;MAA1B;IAAJ,CAAD,CAAZ;EACP,CATD;;EAUA,MAAMM,gBAAgB,GAAGP,CAAC,IAAI;IAC1BA,CAAC,CAACQ,cAAF;IACAJ,OAAO,CAACC,GAAR,CAAYd,MAAZ;;IACA,IAAGe,YAAY,EAAf,EACA;MACInB,KAAK,CAACsB,gBAAN,CAAuBlB,MAAvB,EAA8B,MAAI;QAACmB,MAAM,CAACC,KAAP,CAAa,WAAb;MAA0B,CAA7D;IACH;EACJ,CAPD;;EAQA,MAAM,CAACC,MAAD,EAAQC,SAAR,IAAqBhC,QAAQ,CAAC,EAAD,CAAnC;;EAEA,MAAMyB,YAAY,GAAG,YAAuC;IAAA,IAAtCQ,eAAsC,uEAAtB1B,kBAAsB;IAAC;IACzD,IAAI2B,IAAI,GAAC,EAAT;IACAX,OAAO,CAACC,GAAR,CAAYS,eAAZ;IACAV,OAAO,CAACC,GAAR,CAAYd,MAAZ;IACAyB,MAAM,CAACC,IAAP,CAAYH,eAAZ,EAA6BI,GAA7B,CAAiC,CAACC,GAAD,EAAKC,CAAL,KAAS;MAAC;MACvC,IAAGN,eAAe,CAACK,GAAD,CAAf,CAAqBE,QAArB,IAAiC,CAAC9B,MAAM,CAAC4B,GAAD,CAA3C,EACA;QACIf,OAAO,CAACC,GAAR,CAAYc,GAAG,GAAC,GAAJ,GAAQ5B,MAAM,CAAC4B,GAAD,CAA1B;QACAJ,IAAI,CAACI,GAAD,CAAJ,GAAU5B,MAAM,CAAC4B,GAAD,CAAN,GAAY,EAAZ,GAAe,yBAAzB;MACH;;MACD,IAAG5B,MAAM,CAAC4B,GAAD,CAAN,IAAeL,eAAe,CAACK,GAAD,CAAf,CAAqBG,OAAvC,EACA;QACI,MAAMC,KAAK,GAACC,MAAM,CAACV,eAAe,CAACK,GAAD,CAAf,CAAqBG,OAAtB,EAA8B,GAA9B,CAAlB;QACAP,IAAI,CAACI,GAAD,CAAJ,GAAYI,KAAK,CAACE,IAAN,CAAWlC,MAAM,CAAC4B,GAAD,CAAjB,IAAwB,EAAxB,GAA2B,eAAvC;MACH;IAEJ,CAZD;IAaAf,OAAO,CAACC,GAAR,CAAYU,IAAZ;IACAF,SAAS,CAAC,EACN,GAAGE;IADG,CAAD,CAAT;IAGA,IAAGD,eAAe,IAAE1B,kBAApB,EACI,OAAO4B,MAAM,CAACzB,MAAP,CAAcwB,IAAd,EAAoBW,KAApB,CAA0BC,CAAC,IAAGA,CAAC,IAAI,EAAnC,CAAP;EACP,CAvBD;;EAwBA,OAAO;IACHpC,MADG;IAEHC,SAFG;IAGHO,iBAHG;IAIHN,UAJG;IAKHE,UALG;IAMHC,aANG;IAOHW,gBAPG;IAQHD,YARG;IASHlB,kBATG;IAUHC,qBAVG;IAWHuB,MAXG;IAYHC;EAZG,CAAP;AAcH,CApED;;GAAM5B,O;;AAqEN,MAAM2C,eAAe,GAAGC,KAAK,KAAK;EAC9BC,cAAc,EAACD,KAAK,CAACE,UAAN,CAAiBC;AADF,CAAL,CAA7B;;AAIA,MAAMC,gBAAgB,GAAG;EACrBxB,gBAAgB,EAACzB,OAAO,CAACkD,MADJ;EAErBC,gBAAgB,EAACnD,OAAO,CAACoD;AAFJ,CAAzB;AAIA,eAAerD,OAAO,CAAC6C,eAAD,EAAiBK,gBAAjB,CAAP,CAA0ChD,OAA1C,CAAf"},"metadata":{},"sourceType":"module"}